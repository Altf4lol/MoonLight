/*
 * MoonLight Hacked Client
 *
 * A free and open-source hacked client for Minecraft.
 * Developed using Minecraft's resources.
 *
 * Repository: https://github.com/randomguy3725/MoonLight
 *
 * Author(s): [RandomGuy & opZywl]
 */
package wtf.moonlight.features.modules.impl.exploit;

import wtf.moonlight.events.annotations.EventTarget;
import wtf.moonlight.events.impl.player.AttackEvent;
import wtf.moonlight.events.impl.player.UpdateEvent;
import wtf.moonlight.features.modules.Module;
import wtf.moonlight.features.modules.ModuleCategory;
import wtf.moonlight.features.modules.ModuleInfo;
import wtf.moonlight.features.values.impl.SliderValue;
import wtf.moonlight.utils.math.MathUtils;
import wtf.moonlight.utils.packet.PingSpoofComponent;

@ModuleInfo(name = "FakeLag", category = ModuleCategory.Exploit)
public class FakeLag extends Module {
    private final SliderValue minMs = new SliderValue("Min MS", 200, 0, 5000, 1, this);
    private final SliderValue maxMs = new SliderValue("Max MS", 200, 0, 2000, 1, this);

    @EventTarget
    public void onUpdate(UpdateEvent event) {
        int ms = (int) MathUtils.getAdvancedRandom(minMs.get(), maxMs.get());
        setTag(ms + "ms");
        boolean blinkIncoming = true;
        PingSpoofComponent.spoof(ms, blinkIncoming, blinkIncoming, blinkIncoming, blinkIncoming, blinkIncoming, true);

        if (mc.thePlayer.hurtTime > 0) {
            PingSpoofComponent.dispatch();
        }
    }

    @EventTarget
    public void onAttack(AttackEvent event) {
        event.setCancelled(false);
        PingSpoofComponent.dispatch();
    }
}
